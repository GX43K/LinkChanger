<!doctype html>
<html lang="ps">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tuinty / LinkPass â€” Single HTML</title>
  <style>
    body{font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial; background:#f7fafc; color:#0b1220; padding:28px}
    .card{max-width:720px;margin:0 auto;background:#fff;padding:18px;border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,0.06)}
    h1{margin:0 0 8px;font-size:20px}
    label{display:block;margin-top:12px;color:#374151;font-size:14px}
    input[type=text], textarea, select{width:100%;padding:10px;margin-top:8px;border:1px solid #e6e9ef;border-radius:8px;font-size:14px}
    .row{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
    button{background:#2563eb;color:#fff;border:none;padding:10px 12px;border-radius:8px;cursor:pointer;font-weight:600}
    button.ghost{background:transparent;color:#2563eb;border:1px solid rgba(37,99,235,0.12)}
    .result{margin-top:14px;padding:12px;border-radius:10px;background:#f8fafc;border:1px solid rgba(2,6,23,0.03)}
    .label{font-weight:600;color:#0b1220}
    .muted{color:#6b7280;font-size:13px}
    .preview{margin-top:12px;padding:14px;border-radius:12px;border:1px solid rgba(2,6,23,0.06);max-width:420px}
    .btn-preview{display:inline-block;padding:8px 12px;border-radius:10px;text-decoration:none;border:1px solid rgba(2,6,23,0.08);font-weight:700}
    .small{font-size:13px;color:#6b7280}
    .qr img{border-radius:8px;margin-top:8px}
    code{background:#eef2ff;padding:2px 6px;border-radius:6px}
  </style>
</head>
<body>
  <div class="card">
    <h1>ğŸŒ Tuinty / LinkPass â€” Single HTML</h1>
    <p class="muted">ÛŒÙˆ Ù„ÛŒÙ†Ú© Ø¯Ù†Ù†Ù‡ Ú©Ú“Ø¦Ø› Ø¯Ø§ ØµÙØ­Û Ø¨Ù‡ ÛŒÙˆ Ù…Ø®ØªØµØ± (LinkPass) Ø¬ÙˆÚ“ Ú©Ú“ÙŠ Ø§Ùˆ Ù‡ØºÙ‡ Ù„ÛŒÙ†Ú© Ø¯ Ú©ÙˆÚ‰ Ù¾Ù‡ Ø´Ú©Ù„ Ú©Û Ù¾Ù‡ URL Ù‡ÙØ´ Ú©Û ÚØ§ÛŒ Ù¾Ø± ÚØ§ÛŒ Ú©Ú“ÙŠ. Ú©Ù„Ù‡ Ú†Û Ú…ÙˆÚ© Ù‡ØºÙ‡ Ù„ÛŒÙ†Ú© Ø®Ù„Ø§Øµ Ú©Ú“ÙŠØŒ Ø¯ÙˆÛŒ Ø¨Ù‡ Ù…Ø³ØªÙ‚ÛŒÙ… Ø§ØµÙ„ÙŠ Ù„ÛŒÙ†Ú© ØªÙ‡ ÙˆÙ„Ø§Ú“ Ø´ÙŠ.</p>

    <label>Ø§ØµÙ„ÙŠ Ù„ÛŒÙ†Ú© (Ù…Ø«Ù„Ø§Ù‹ https://t.me/MyBot?start=hello)</label>
    <input id="orig" type="text" placeholder="Ø§ØµÙ„ÙŠ Ù„ÛŒÙ†Ú© Ø¯Ù†Ù†Ù‡ Ú©Ú“Ø¦..." />

    <label>Ø¯ ÚšÙˆØ¯Ù„Ùˆ Ù„Ù¾Ø§Ø±Ù‡ Ø¨Ø±Ú†Ø³Ø¨ / Ù†ÙˆÙ… (Ø§Ø®ØªÛŒØ§Ø±ÙŠ)</label>
    <input id="label" type="text" placeholder="Ù…Ø«Ù„Ø§Ù‹ My promo link" />

    <div class="row">
      <button id="gen">LinkPass Ø¬ÙˆÚ“ Ú©Ú“Ù‡</button>
      <button id="copy" class="ghost" title="Ú©Ø§Ù¾ÙŠ ÙˆØ±ÙˆØ³ØªÛŒ Ø¬ÙˆÚ“ Ø´ÙˆÛŒ Ù„ÛŒÙ†Ú©">Ú©Ø§Ù¾ÙŠ</button>
      <button id="qrBtn" class="ghost">QR Ø¬ÙˆÚ“ Ú©Ú“Ù‡</button>
      <button id="clear" class="ghost">Ù¾Ø§Ú© ÙˆÙ„</button>
    </div>

    <div id="out" class="result" style="display:none">
      <div class="small">Ø³ØªØ§Ø³Ùˆ LinkPass:</div>
      <div style="margin-top:8px">
        <span class="label">Tuinty/linkpass/</span><span id="codeText" style="font-family:monospace;font-weight:700"></span>
      </div>

      <div style="margin-top:10px" class="muted">Ù‚Ø§Ø¨Ù„ Ú©Ù„ÛŒÚ© Ù„ÛŒÙ†Ú© (Ø´Ø±ÛŒÚ© Ú©Ú“Ø¦):</div>
      <div style="margin-top:6px">
        <a id="shareLink" href="#" target="_blank"></a>
      </div>

      <div class="preview" id="preview">
        <div id="previewTitle" style="font-weight:700">Preview title</div>
        <div id="previewSub" class="muted" style="margin-top:6px">Ø¯Ú©Ù…Ù‡ â€” target URL</div>
        <a id="previewBtn" class="btn-preview" href="#" target="_blank">Open Link</a>
      </div>

      <div id="qrWrap" class="qr" style="display:none"></div>
    </div>

    <div style="margin-top:12px" class="small">
      Ù†ÙˆÙ¼: Ø¯Ø§ ÙØ§ÛŒÙ„ Ù‡ÛŒÚ… Ø³Ø±ÙˆØ± ØªÙ‡ Ø§Ú“ØªÛŒØ§ Ù†Ù„Ø±ÙŠ. Ø¯Ø§ Ø¯ Ù„ÛŒÙ†Ú© Ù…Ø­ØªÙˆØ§ (Ø§ØµÙ„ÙŠ URL) Ø¯Ù†Ù†Ù‡ Ù¾Ù‡ Base64 Ú©ÙˆÚ‰ Ú©ÙˆÙŠ Ø§Ùˆ Ù¾Ù‡ Ù‡ÙØ´ (fragment) Ú©Û ÛŒÛ Ø³Ø§ØªÙŠØ› Ù†Ùˆ Ú©Ù„Ù‡ Ú†Û Ú…ÙˆÚ© Ø´Ø±ÛŒÚ© Ø´ÙˆÛŒ Ù„ÛŒÙ†Ú© Ø®Ù„Ø§Øµ Ú©Ú“ÙŠØŒ Ø¯Ø§ ÙØ§ÛŒÙ„ Ù‡ØºÙ‡ Ù‡ÙØ´ ØªØ­Ù„ÛŒÙ„ Ø§Ùˆ Ø±ÛŒÚ‰Ø§ÛŒØ±ÛÚ©Ù¼ Ú©ÙˆÙŠ. Ø¯ ÚšÚ©Ù„Ø§ Ù„Ù¾Ø§Ø±Ù‡ Ù…ÙˆÚ– Ø¯ "Tuinty/linkpass/XXXXXX" Ø¨Ø±Ú†Ø³Ø¨ ÚšÛŒÙˆ Ø®Ùˆ Ø­Ù‚ÛŒÙ‚ÙŠ redirect Ø¯ Ù‡ÙØ´ Ø¯Ù†Ù†Ù‡ Ú©ÙˆÚ‰ Ø´ÙˆÛŒ URL Ú…Ø®Ù‡ Ú©ÛŒÚ–ÙŠ.
    </div>
  </div>

<script>
  // utility: generate short code (6 chars, base36)
  function makeCode(len = 6) {
    const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
    let s = '';
    for (let i=0;i<len;i++) s += chars[Math.floor(Math.random()*chars.length)];
    return s;
  }

  // utf8-safe base64
  function b64EncodeUnicode(str) {
    // first we escape the string using encodeURIComponent to get the UTF-8 encoding,
    // then we convert the percent encodings into raw bytes, and finally btoa.
    return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,
      function(match, p1) {
        return String.fromCharCode('0x' + p1);
      }));
  }
  function b64DecodeUnicode(str) {
    return decodeURIComponent(Array.prototype.map.call(atob(str), function(c) {
      return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));
  }

  // build share URL: current page + #lp=CODE&u=BASE64(url)&t=label
  function buildShareLink(code, url, label) {
    const base = location.href.split('#')[0];
    const u = encodeURIComponent(b64EncodeUnicode(url));
    const t = label ? encodeURIComponent(b64EncodeUnicode(label)) : '';
    return `${base}#lp=${code}&u=${u}${t?('&t='+t):''}`;
  }

  // parse hash on load for redirect
  function parseHashAndMaybeRedirect() {
    const h = location.hash.slice(1);
    if (!h) return;
    const params = new URLSearchParams(h);
    const uenc = params.get('u');
    if (!uenc) return;
    try {
      const url = b64DecodeUnicode(decodeURIComponent(uenc));
      // optional: show a simple interstitial with 1s delay (user-friendly)
      const page = document.body;
      page.innerHTML = '<div style="font-family:system-ui,Arial;display:flex;align-items:center;justify-content:center;height:100vh;background:#fafafa"><div style="background:#fff;padding:20px;border-radius:12px;box-shadow:0 10px 30px rgba(2,6,23,0.06);max-width:520px;text-align:center"><h2 style="margin:0 0 8px">You are being redirectedâ€¦</h2><p style="color:#6b7280;margin:0 0 12px">Opening the destination link now.</p><a id="go" href="' + url + '" style="display:inline-block;padding:10px 14px;border-radius:8px;background:#2563eb;color:#fff;text-decoration:none;font-weight:700">Open now</a><div style="margin-top:12px;color:#94a3b8">If nothing happens, click the button above.</div></div></div>';
      // auto-redirect after short delay (1s)
      setTimeout(()=>{ window.location.href = url; }, 900);
    } catch (e) {
      console.error('failed to decode URL', e);
    }
  }

  // UI handlers
  document.getElementById('gen').addEventListener('click', ()=>{
    const orig = document.getElementById('orig').value.trim();
    if (!orig) { alert('Ù…Ù‡Ø±Ø¨Ø§Ù†ÙŠ ÙˆÚ©Ú“Ø¦ Ø§ØµÙ„ÙŠ Ù„ÛŒÙ†Ú© Ø¯Ù†Ù†Ù‡ Ú©Ú“Ø¦.'); return; }
    // basic validation
    try {
      new URL(orig); // will throw if invalid (but accepts relative URLs too)
    } catch (e) {
      // allow as-is but warn
      if (!confirm('Ù…Ø­ØªØ§Ø· Ø§ÙˆØ³Ø¦: ÙˆØ±Ú©Ú“Ù„ Ø´ÙˆÛŒ Ù…ØªÙ† ÚšØ§ÛŒÙŠ Ù‚Ø§Ù†ÙˆÙ†ÙŠ URL Ù†Ù‡ ÙˆÙŠ. Ø§Ø¯Ø§Ù…Ù‡ ØºÙˆØ§Ú“Ø¦ØŸ')) return;
    }

    const label = document.getElementById('label').value.trim();
    const code = makeCode(6);
    const share = buildShareLink(code, orig, label);

    // display (we show "Tuinty/linkpass/CODE" visually)
    document.getElementById('codeText').textContent = code;
    const shareEl = document.getElementById('shareLink');
    shareEl.href = share;
    shareEl.textContent = share;
    document.getElementById('previewTitle').textContent = label || 'Tuinty LinkPass';
    document.getElementById('previewSub').textContent = (label? label + ' â€” ' : '') + orig;
    const btn = document.getElementById('previewBtn');
    btn.href = share;
    btn.textContent = label? label : 'Open Link';

    // show
    document.getElementById('out').style.display = 'block';
    // enable copy
    document.getElementById('copy').disabled = false;
  });

  document.getElementById('copy').addEventListener('click', ()=>{
    const a = document.getElementById('shareLink');
    if (!a.href) return alert('Ø§ÙˆÙ„ Ù„ÛŒÙ†Ú© Ø¬ÙˆÚ“ Ú©Ú“Ø¦');
    navigator.clipboard?.writeText(a.href).then(()=>{ alert('Ù„ÛŒÙ†Ú© Ú©Ø§Ù¾ÙŠ Ø´Ùˆ'); }).catch(()=>{ prompt('Ø¯Ø§ Ù„ÛŒÙ†Ú© Ú©Ø§Ù¾ÙŠ Ú©Ú“Ø¦:', a.href); });
  });

  document.getElementById('qrBtn').addEventListener('click', ()=>{
    const a = document.getElementById('shareLink');
    if (!a.href) return alert('Ø§ÙˆÙ„ Ù„ÛŒÙ†Ú© Ø¬ÙˆÚ“ Ú©Ú“Ø¦');
    const qWrap = document.getElementById('qrWrap');
    // Use chart.googleapis (no server needed). Note: sometimes blocked in some regions.
    const qUrl = 'https://chart.googleapis.com/chart?cht=qr&chs=300x300&chl=' + encodeURIComponent(a.href);
    qWrap.style.display = 'block';
    qWrap.innerHTML = '<div class="small muted">QR (scan to open):</div><img src="' + qUrl + '" alt="QR code" width="220" height="220" />';
  });

  document.getElementById('clear').addEventListener('click', ()=>{
    document.getElementById('orig').value = '';
    document.getElementById('label').value = '';
    document.getElementById('out').style.display = 'none';
    document.getElementById('qrWrap').style.display = 'none';
  });

  // On load: if page opened with hash containing u=..., redirect
  parseHashAndMaybeRedirect();
</script>
</body>
</html> 
