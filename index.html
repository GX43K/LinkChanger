<!doctype html>
<html lang="ps">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Tuinty LinkPass Builder — Static (HTML)</title>
<style>
  :root{--bg:#f6f8fb;--card:#fff;--accent:#2563eb;--muted:#64748b}
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:0;background:var(--bg);color:#0f172a;padding:28px}
  .wrap{max-width:980px;margin:0 auto;display:grid;grid-template-columns:1fr 420px;gap:20px}
  .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,0.06)}
  h1{margin:0 0 8px;font-size:20px}
  label{display:block;font-size:13px;color:var(--muted);margin-top:10px}
  input[type=text], textarea, select{width:100%;padding:10px;margin-top:8px;border:1px solid #e6e9ef;border-radius:8px;font-size:14px}
  .row{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
  button{background:var(--accent);color:white;border:none;padding:10px 12px;border-radius:8px;cursor:pointer;font-weight:600}
  button.ghost{background:transparent;color:var(--accent);border:1px solid rgba(37,99,235,0.12)}
  pre{background:#f1f5f9;padding:12px;border-radius:8px;overflow:auto}
  .muted{color:var(--muted);font-size:13px}
  .small{font-size:13px;color:var(--muted)}
  .out{margin-top:12px}
  a.short{color:var(--accent);font-weight:700}
  @media(max-width:900px){.wrap{grid-template-columns:1fr}}
</style>
</head>
<body>
  <div class="wrap">
    <main class="card">
      <h1>🔧 Tuinty LinkPass Builder (Static)</h1>
      <p class="small">یو لینک دننه کړئ، بیا کولای شئ د Netlify redirects کرښه کاپي/ډاونلوډ کړئ یا د جلا HTML redirect فایل ترلاسه کړئ چې ستاسو هاست ته اپلوډ کړئ.</p>

      <label>اصلي لینک (destination URL)</label>
      <input id="orig" type="text" placeholder="مثلاً: https://t.me/MyBot?start=hello" />

      <label>لنډ کوډ (که خالي پرېږدئ، اتومات به جوړ شي)</label>
      <input id="code" type="text" placeholder="مثلاً: abc123" />

      <label>لنډ برچسب/نوم (اختیاري، یوازې د ښودلو لپاره)</label>
      <input id="label" type="text" placeholder="مثلاً: Promo Link 1" />

      <div class="row">
        <button id="gen">Generate</button>
        <button id="copyRedirect" class="ghost" disabled>کاپي _redirects کرښه</button>
        <button id="downloadRedirect" class="ghost" disabled>ډاونلوډ _redirects.txt</button>
        <button id="downloadHtml" class="ghost" disabled>ډاونلوډ pass/FILE.html</button>
      </div>

      <div class="out" id="out" style="display:none">
        <div class="muted">د ښودلو لنډ لینک:</div>
        <div style="margin-top:6px"><span class="small">https://www.tintyj.com/pass/</span><span id="showCode" style="font-family:monospace;font-weight:700"></span></div>

        <div style="margin-top:10px" class="muted">Netlify / Vercel Redirect rule (copy this into <code>_redirects</code>):</div>
        <pre id="redirectLine" style="margin-top:6px"></pre>

        <div style="margin-top:10px" class="muted">Standalone HTML (pass/CODE.html):</div>
        <pre id="htmlFile" style="margin-top:6px"></pre>

        <div style="margin-top:10px" class="muted">نوټ: که د Netlify / Vercel کاروئ، د ریښه فولډر کې `_redirects` فایل ته د لاندې کرښو اضافه کول به دې URL ته مستقیم ریډایرېکټ ورکوي (بې منځنۍ پاڼې).</div>
      </div>
    </main>

    <aside class="card">
      <h3 style="margin-top:0">څنګه یې کاروي</h3>
      <ol class="small">
        <li>اصلي لینک دننه کړئ.</li>
        <li>که غواړئ مشخص کوډ ورکړئ، داخل یې کړئ، که نه خالي پریږدئ — اتومات کوډ جوړېږي.</li>
        <li>Generate تڼۍ ووهئ.</li>
        <li>کاپي یا ډاونلوډ د `_redirects` کرښه او خپل Netlify پروژه ته اضافه کړئ؛ یا یوازې `pass/CODE.html` فایل ډاونلوډ او په هاست کې اپلوډ کړئ.</li>
      </ol>

      <h4 style="margin-top:12px">مثالونه</h4>
      <div class="small">
        <p><strong>_redirects کرښه (Netlify):</strong><br><code>/pass/abc123 https://t.me/MyBot?start=hello 301</code></p>
        <p><strong>جلا HTML فایل:</strong><br><code>pass/abc123.html</code> کې meta refresh یا JavaScript redirect وي.</p>

        <h4 style="margin-top:10px">ډومېن</h4>
        <p class="small">د ښې پایلې لپاره خپل ډومېن (مثلاً <em>www.tintyj.com</em>) د Netlify یا GitHub Pages سره وصل کړئ؛ که Netlify وکاروئ، `_redirects` فایل به مستقیم ریډایرېکټ وکړي.</p>
      </div>
    </aside>
  </div>

<script>
  // utilities
  function randCode(len=6){
    const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
    let s='';
    for(let i=0;i<len;i++) s+=chars[Math.floor(Math.random()*chars.length)];
    return s;
  }

  function makeRedirectLine(code, dest){
    // return a Netlify/Vercel style redirect line
    // Ensure dest contains spaces? wrap not needed but safer to quote if spaces exist
    return `/pass/${code} ${dest} 301`;
  }

  function makeHtmlFileContent(dest){
    // Use fast redirect (meta-refresh + JS fallback)
    const safe = dest.replace(/"/g,'&quot;');
    return `<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="refresh" content="0; url=${safe}">
<title>Redirecting...</title>
<script>window.location.replace(${JSON.stringify(dest)});</script>
</head>
<body>
  <p>Redirecting... <a href="${safe}">Click here if not redirected</a></p>
</body>
</html>`;
  }

  // DOM
  const origEl = document.getElementById('orig');
  const codeEl = document.getElementById('code');
  const labelEl = document.getElementById('label');
  const genBtn = document.getElementById('gen');
  const outDiv = document.getElementById('out');
  const showCode = document.getElementById('showCode');
  const redirectLinePre = document.getElementById('redirectLine');
  const htmlFilePre = document.getElementById('htmlFile');
  const copyRedirect = document.getElementById('copyRedirect');
  const downloadRedirect = document.getElementById('downloadRedirect');
  const downloadHtml = document.getElementById('downloadHtml');

  let current = { code:'', dest:'' };

  genBtn.addEventListener('click', ()=>{
    const dest = origEl.value.trim();
    if(!dest){ alert('مهرباني وکړئ اصلي لینک دننه کړئ.'); return; }
    // basic URL check (allow mailto or relative too)
    try { new URL(dest); } catch(e){ if(!confirm('ښايي ورکړل شوی متن حقیقي URL نه وي. ادامه غواړئ؟')) return; }

    const code = (codeEl.value.trim() || randCode(6));
    const label = labelEl.value.trim();

    const redirectLine = makeRedirectLine(code, dest);
    const htmlContent = makeHtmlFileContent(dest);

    current = { code, dest, redirectLine, htmlContent, filename:`pass-${code}.html` };

    showCode.textContent = code;
    redirectLinePre.textContent = redirectLine;
    htmlFilePre.textContent = htmlContent;
    outDiv.style.display = 'block';
    copyRedirect.disabled = false;
    downloadRedirect.disabled = false;
    downloadHtml.disabled = false;
  });

  // copy redirect line
  copyRedirect.addEventListener('click', ()=>{
    if(!current.redirectLine) return alert('اول Generate وکړئ');
    navigator.clipboard?.writeText(current.redirectLine).then(()=>alert('کاپي شو')).catch(()=>{ prompt('کاپي خط:', current.redirectLine) });
  });

  // download redirects file (single-line txt)
  downloadRedirect.addEventListener('click', ()=>{
    if(!current.redirectLine) return alert('اول Generate وکړئ');
    const blob = new Blob([current.redirectLine+"\n"], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = '_redirects.txt';
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
  });

  // download html redirect file
  downloadHtml.addEventListener('click', ()=>{
    if(!current.htmlContent) return alert('اول Generate وکړئ');
    const blob = new Blob([current.htmlContent], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `${current.filename}`;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
  });
</script>
</body>
</html> 
